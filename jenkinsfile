pipeline {
	agent	{
				label	
				{
					label 'built-in'
					customWorkspace '/mnt/projects/22Q1/'
				}
			}
	
	stages {
			stage('cloning') 
					{
						steps 
						{ 
								sh 'rm -rf *'
								sh 'git clone https://github.com/amit-hajare/velocity-app.git -b 22Q1'
								
						}
					}
			stage('install-apache')    
                    {
                        steps   {
                                    sh 'yum install httpd -y'
                                }
                    }
			stage('start-apache')    
                    {
                        steps   {
                                    sh 'service httpd start'
                                }
                    }
			
			stage('deploy-index')    
                    {
                        steps   {
				                    sh 'cp /mnt/linux-key-pair.pem /mnt/projects/22Q1/'
				                    sh 'chmod -R 777 /mnt/projects/22Q1/velocity-app/index.html'
                                    sh 'scp -i "linux-key-pair.pem" /mnt/projects/22Q1/velocity-app/index.html ec2-user@172.31.3.29:/var/www/html/'
									
                                }
                    }
		
	}
}
